theme(
#legend.position = "none",
legend.key = element_rect(fill = "white", colour = "black"),
axis.text = element_blank(),
axis.title = element_blank(),
panel.grid = element_blank(),
plot.margin = unit(rep(-1,4), "cm")
) +
coord_polar() +
#labs(fill = "rua") +
# Add labels on top of each bar (company name)
geom_text(data=label_data, aes(x=id, y=tot+10, label=company, hjust=hjust), color="black", fontface="bold",alpha=0.6, size=5, angle= label_data$angle, inherit.aes = FALSE ) +
# Add base line information (policy groups)
geom_segment(data=base_data, aes(x = start, y = -5, xend = end, yend = -5), colour = "black", alpha=0.8, size=0.6 , inherit.aes = FALSE )  +
geom_text(data=base_data, aes(x = title, y = -18, label=policy), hjust=c(1,1,0,0), colour = "black", alpha=0.8, size=4, fontface="bold", inherit.aes = FALSE)
# Save at png
ggsave(p, file="output.png", width=15, height=10)
# Make the plot
p <- ggplot(data) +
# Add the stacked bar
geom_bar(aes(x=as.factor(id), y=value, fill=rua_id), stat="identity", alpha=0.5) +
#scale_fill_viridis_d(
scale_fill_brewer(palette = "Spectral",
name = "rua",
labels = c("self", "dmarcian", "Agari", "Proofpoint", "Vailmail", "Cisco", "Validity", "no reporting")) +
ylim(-150,max(label_data$tot+10, na.rm=T)) +
theme_minimal() +
theme(
#legend.position = "none",
legend.key = element_rect(fill = "white", colour = "black"),
axis.text = element_blank(),
axis.title = element_blank(),
panel.grid = element_blank(),
plot.margin = unit(rep(-1,4), "cm")
) +
coord_polar() +
#labs(fill = "rua") +
# Add labels on top of each bar (company name)
geom_text(data=label_data, aes(x=id, y=tot+10, label=company, hjust=hjust), color="black", fontface="bold",alpha=0.6, size=5, angle= label_data$angle, inherit.aes = FALSE ) +
# Add base line information (policy groups)
geom_segment(data=base_data, aes(x = start, y = -5, xend = end, yend = -5), colour = "black", alpha=0.8, size=0.6 , inherit.aes = FALSE )  +
geom_text(data=base_data, aes(x = title, y = -18, label=policy), hjust=c(1,1,0,0), colour = "black", alpha=0.8, size=4, fontface="bold", inherit.aes = FALSE)
# Save at png
ggsave(p, file="output.png", width=15, height=10)
# Make the plot
p <- ggplot(data) +
# Add the stacked bar
geom_bar(aes(x=as.factor(id), y=value, fill=rua_id), stat="identity") +
#scale_fill_viridis_d(
scale_fill_brewer(palette = "Spectral",
name = "rua",
labels = c("self", "dmarcian", "Agari", "Proofpoint", "Vailmail", "Cisco", "Validity", "no reporting")) +
ylim(-150,max(label_data$tot+10, na.rm=T)) +
theme_minimal() +
theme(
#legend.position = "none",
legend.key = element_rect(fill = "white", colour = "black"),
axis.text = element_blank(),
axis.title = element_blank(),
panel.grid = element_blank(),
plot.margin = unit(rep(-1,4), "cm")
) +
coord_polar() +
#labs(fill = "rua") +
# Add labels on top of each bar (company name)
geom_text(data=label_data, aes(x=id, y=tot+10, label=company, hjust=hjust), color="black", fontface="bold",alpha=0.6, size=5, angle= label_data$angle, inherit.aes = FALSE ) +
# Add base line information (policy groups)
geom_segment(data=base_data, aes(x = start, y = -5, xend = end, yend = -5), colour = "black", alpha=0.8, size=0.6 , inherit.aes = FALSE )  +
geom_text(data=base_data, aes(x = title, y = -18, label=policy), hjust=c(1,1,0,0), colour = "black", alpha=0.8, size=4, fontface="bold", inherit.aes = FALSE)
# Save at png
ggsave(p, file="output.png", width=15, height=10)
# Make the plot
p <- ggplot(data) +
# Add the stacked bar
geom_bar(aes(x=as.factor(id), y=value, fill=rua_id), stat="identity") +
#scale_fill_viridis_d(
scale_fill_brewer(palette = "RdGy",
name = "rua",
labels = c("self", "dmarcian", "Agari", "Proofpoint", "Vailmail", "Cisco", "Validity", "no reporting")) +
ylim(-150,max(label_data$tot+10, na.rm=T)) +
theme_minimal() +
theme(
#legend.position = "none",
legend.key = element_rect(fill = "white", colour = "black"),
axis.text = element_blank(),
axis.title = element_blank(),
panel.grid = element_blank(),
plot.margin = unit(rep(-1,4), "cm")
) +
coord_polar() +
#labs(fill = "rua") +
# Add labels on top of each bar (company name)
geom_text(data=label_data, aes(x=id, y=tot+10, label=company, hjust=hjust), color="black", fontface="bold",alpha=0.6, size=5, angle= label_data$angle, inherit.aes = FALSE ) +
# Add base line information (policy groups)
geom_segment(data=base_data, aes(x = start, y = -5, xend = end, yend = -5), colour = "black", alpha=0.8, size=0.6 , inherit.aes = FALSE )  +
geom_text(data=base_data, aes(x = title, y = -18, label=policy), hjust=c(1,1,0,0), colour = "black", alpha=0.8, size=4, fontface="bold", inherit.aes = FALSE)
# Save at png
ggsave(p, file="output.png", width=15, height=10)
# Make the plot
p <- ggplot(data) +
# Add the stacked bar
geom_bar(aes(x=as.factor(id), y=value, fill=rua_id), stat="identity") +
#scale_fill_viridis_d(
scale_fill_brewer(palette = "PuOr",
name = "rua",
labels = c("self", "dmarcian", "Agari", "Proofpoint", "Vailmail", "Cisco", "Validity", "no reporting")) +
ylim(-150,max(label_data$tot+10, na.rm=T)) +
theme_minimal() +
theme(
legend.key = element_rect(fill = "white", colour = "black"),
axis.text = element_blank(),
axis.title = element_blank(),
panel.grid = element_blank(),
plot.margin = unit(rep(-1,4), "cm")
) +
coord_polar() +
#labs(fill = "rua") +
# Add labels on top of each bar (company name)
geom_text(data=label_data, aes(x=id, y=tot+10, label=company, hjust=hjust), color="black", fontface="bold",alpha=0.6, size=5, angle= label_data$angle, inherit.aes = FALSE ) +
# Add base line information (policy groups)
geom_segment(data=base_data, aes(x = start, y = -5, xend = end, yend = -5), colour = "black", alpha=0.8, size=0.6 , inherit.aes = FALSE )  +
geom_text(data=base_data, aes(x = title, y = -18, label=policy), hjust=c(1,1,0,0), colour = "black", alpha=0.8, size=4, fontface="bold", inherit.aes = FALSE)
# Save at png
ggsave(p, file="output.png", width=15, height=10)
# Make the plot
p <- ggplot(data) +
# Add the stacked bar
geom_bar(aes(x=as.factor(id), y=value, fill=rua_id), stat="identity") +
#scale_fill_viridis_d(
scale_fill_brewer(palette = "Dark2",
name = "rua",
labels = c("self", "dmarcian", "Agari", "Proofpoint", "Vailmail", "Cisco", "Validity", "no reporting")) +
ylim(-150,max(label_data$tot+10, na.rm=T)) +
theme_minimal() +
theme(
legend.key = element_rect(fill = "white", colour = "black"),
axis.text = element_blank(),
axis.title = element_blank(),
panel.grid = element_blank(),
plot.margin = unit(rep(-1,4), "cm")
) +
coord_polar() +
#labs(fill = "rua") +
# Add labels on top of each bar (company name)
geom_text(data=label_data, aes(x=id, y=tot+10, label=company, hjust=hjust), color="black", fontface="bold",alpha=0.6, size=5, angle= label_data$angle, inherit.aes = FALSE ) +
# Add base line information (policy groups)
geom_segment(data=base_data, aes(x = start, y = -5, xend = end, yend = -5), colour = "black", alpha=0.8, size=0.6 , inherit.aes = FALSE )  +
geom_text(data=base_data, aes(x = title, y = -18, label=policy), hjust=c(1,1,0,0), colour = "black", alpha=0.8, size=4, fontface="bold", inherit.aes = FALSE)
# Save at png
ggsave(p, file="output.png", width=15, height=10)
# Make the plot
p <- ggplot(data) +
# Add the stacked bar
geom_bar(aes(x=as.factor(id), y=value, fill=rua_id), stat="identity", alpha=0.2) +
#scale_fill_viridis_d(
scale_fill_brewer(palette = "Dark2",
name = "rua",
labels = c("self", "dmarcian", "Agari", "Proofpoint", "Vailmail", "Cisco", "Validity", "no reporting")) +
ylim(-150,max(label_data$tot+10, na.rm=T)) +
theme_minimal() +
theme(
legend.key = element_rect(fill = "white", colour = "black"),
axis.text = element_blank(),
axis.title = element_blank(),
panel.grid = element_blank(),
plot.margin = unit(rep(-1,4), "cm")
) +
coord_polar() +
#labs(fill = "rua") +
# Add labels on top of each bar (company name)
geom_text(data=label_data, aes(x=id, y=tot+10, label=company, hjust=hjust), color="black", fontface="bold",alpha=0.6, size=5, angle= label_data$angle, inherit.aes = FALSE ) +
# Add base line information (policy groups)
geom_segment(data=base_data, aes(x = start, y = -5, xend = end, yend = -5), colour = "black", alpha=0.8, size=0.6 , inherit.aes = FALSE )  +
geom_text(data=base_data, aes(x = title, y = -18, label=policy), hjust=c(1,1,0,0), colour = "black", alpha=0.8, size=4, fontface="bold", inherit.aes = FALSE)
# Save at png
ggsave(p, file="output.png", width=15, height=10)
# Make the plot
p <- ggplot(data) +
# Add the stacked bar
geom_bar(aes(x=as.factor(id), y=value, fill=rua_id), stat="identity", alpha=0.7) +
#scale_fill_viridis_d(
scale_fill_brewer(palette = "Dark2",
name = "rua",
labels = c("self", "dmarcian", "Agari", "Proofpoint", "Vailmail", "Cisco", "Validity", "no reporting")) +
ylim(-150,max(label_data$tot+10, na.rm=T)) +
theme_minimal() +
theme(
legend.key = element_rect(fill = "white", colour = "black"),
axis.text = element_blank(),
axis.title = element_blank(),
panel.grid = element_blank(),
plot.margin = unit(rep(-1,4), "cm")
) +
coord_polar() +
#labs(fill = "rua") +
# Add labels on top of each bar (company name)
geom_text(data=label_data, aes(x=id, y=tot+10, label=company, hjust=hjust), color="black", fontface="bold",alpha=0.6, size=5, angle= label_data$angle, inherit.aes = FALSE ) +
# Add base line information (policy groups)
geom_segment(data=base_data, aes(x = start, y = -5, xend = end, yend = -5), colour = "black", alpha=0.8, size=0.6 , inherit.aes = FALSE )  +
geom_text(data=base_data, aes(x = title, y = -18, label=policy), hjust=c(1,1,0,0), colour = "black", alpha=0.8, size=4, fontface="bold", inherit.aes = FALSE)
# Save at png
ggsave(p, file="output.png", width=15, height=10)
# Make the plot
p <- ggplot(data) +
# Add the stacked bar
geom_bar(aes(x=as.factor(id), y=value, fill=rua_id), stat="identity") +
#scale_fill_viridis_d(
scale_fill_brewer(palette = "Accent",
name = "rua",
labels = c("self", "dmarcian", "Agari", "Proofpoint", "Vailmail", "Cisco", "Validity", "no reporting")) +
ylim(-150,max(label_data$tot+10, na.rm=T)) +
theme_minimal() +
theme(
legend.key = element_rect(fill = "white", colour = "black"),
axis.text = element_blank(),
axis.title = element_blank(),
panel.grid = element_blank(),
plot.margin = unit(rep(-1,4), "cm")
) +
coord_polar() +
#labs(fill = "rua") +
# Add labels on top of each bar (company name)
geom_text(data=label_data, aes(x=id, y=tot+10, label=company, hjust=hjust), color="black", fontface="bold",alpha=0.6, size=5, angle= label_data$angle, inherit.aes = FALSE ) +
# Add base line information (policy groups)
geom_segment(data=base_data, aes(x = start, y = -5, xend = end, yend = -5), colour = "black", alpha=0.8, size=0.6 , inherit.aes = FALSE )  +
geom_text(data=base_data, aes(x = title, y = -18, label=policy), hjust=c(1,1,0,0), colour = "black", alpha=0.8, size=4, fontface="bold", inherit.aes = FALSE)
# Save at png
ggsave(p, file="output.png", width=15, height=10)
# Make the plot
p <- ggplot(data) +
# Add the stacked bar
geom_bar(aes(x=as.factor(id), y=value, fill=rua_id), stat="identity") +
#scale_fill_viridis_d(
scale_fill_brewer(palette = "Set1",
name = "rua",
labels = c("self", "dmarcian", "Agari", "Proofpoint", "Vailmail", "Cisco", "Validity", "no reporting")) +
ylim(-150,max(label_data$tot+10, na.rm=T)) +
theme_minimal() +
theme(
legend.key = element_rect(fill = "white", colour = "black"),
axis.text = element_blank(),
axis.title = element_blank(),
panel.grid = element_blank(),
plot.margin = unit(rep(-1,4), "cm")
) +
coord_polar() +
#labs(fill = "rua") +
# Add labels on top of each bar (company name)
geom_text(data=label_data, aes(x=id, y=tot+10, label=company, hjust=hjust), color="black", fontface="bold",alpha=0.6, size=5, angle= label_data$angle, inherit.aes = FALSE ) +
# Add base line information (policy groups)
geom_segment(data=base_data, aes(x = start, y = -5, xend = end, yend = -5), colour = "black", alpha=0.8, size=0.6 , inherit.aes = FALSE )  +
geom_text(data=base_data, aes(x = title, y = -18, label=policy), hjust=c(1,1,0,0), colour = "black", alpha=0.8, size=4, fontface="bold", inherit.aes = FALSE)
# Save at png
ggsave(p, file="output.png", width=15, height=10)
# Make the plot
p <- ggplot(data) +
# Add the stacked bar
geom_bar(aes(x=as.factor(id), y=value, fill=rua_id), stat="identity") +
#scale_fill_viridis_d(
scale_fill_brewer(palette = "Set2",
name = "rua",
labels = c("self", "dmarcian", "Agari", "Proofpoint", "Vailmail", "Cisco", "Validity", "no reporting")) +
ylim(-150,max(label_data$tot+10, na.rm=T)) +
theme_minimal() +
theme(
legend.key = element_rect(fill = "white", colour = "black"),
axis.text = element_blank(),
axis.title = element_blank(),
panel.grid = element_blank(),
plot.margin = unit(rep(-1,4), "cm")
) +
coord_polar() +
#labs(fill = "rua") +
# Add labels on top of each bar (company name)
geom_text(data=label_data, aes(x=id, y=tot+10, label=company, hjust=hjust), color="black", fontface="bold",alpha=0.6, size=5, angle= label_data$angle, inherit.aes = FALSE ) +
# Add base line information (policy groups)
geom_segment(data=base_data, aes(x = start, y = -5, xend = end, yend = -5), colour = "black", alpha=0.8, size=0.6 , inherit.aes = FALSE )  +
geom_text(data=base_data, aes(x = title, y = -18, label=policy), hjust=c(1,1,0,0), colour = "black", alpha=0.8, size=4, fontface="bold", inherit.aes = FALSE)
# Save at png
ggsave(p, file="output.png", width=15, height=10)
# Make the plot
p <- ggplot(data) +
# Add the stacked bar
geom_bar(aes(x=as.factor(id), y=value, fill=rua_id), stat="identity") +
#scale_fill_viridis_d(
scale_fill_brewer(palette = "Spectral",
name = "rua",
labels = c("self", "dmarcian", "Agari", "Proofpoint", "Vailmail", "Cisco", "Validity", "no reporting")) +
ylim(-150,max(label_data$tot+10, na.rm=T)) +
theme_minimal() +
theme(
legend.key = element_rect(fill = "white", colour = "black"),
axis.text = element_blank(),
axis.title = element_blank(),
panel.grid = element_blank(),
plot.margin = unit(rep(-1,4), "cm")
) +
coord_polar() +
#labs(fill = "rua") +
# Add labels on top of each bar (company name)
geom_text(data=label_data, aes(x=id, y=tot+10, label=company, hjust=hjust), color="black", fontface="bold",alpha=0.6, size=5, angle= label_data$angle, inherit.aes = FALSE ) +
# Add base line information (policy groups)
geom_segment(data=base_data, aes(x = start, y = -5, xend = end, yend = -5), colour = "black", alpha=0.8, size=0.6 , inherit.aes = FALSE )  +
geom_text(data=base_data, aes(x = title, y = -18, label=policy), hjust=c(1,1,0,0), colour = "black", alpha=0.8, size=4, fontface="bold", inherit.aes = FALSE)
# Save at png
ggsave(p, file="output.png", width=15, height=10)
# Make the plot
p <- ggplot(data) +
# Add the stacked bar
geom_bar(aes(x=as.factor(id), y=value, fill=rua_id), stat="identity", alpha=0.7) +
scale_fill_viridis_d(,
name = "rua",
labels = c("self", "dmarcian", "Agari", "Proofpoint", "Vailmail", "Cisco", "Validity", "no reporting")) +
ylim(-150,max(label_data$tot+10, na.rm=T)) +
theme_minimal() +
theme(
legend.key = element_rect(fill = "white", colour = "black"),
axis.text = element_blank(),
axis.title = element_blank(),
panel.grid = element_blank(),
plot.margin = unit(rep(-1,4), "cm")
) +
coord_polar() +
#labs(fill = "rua") +
# Add labels on top of each bar (company name)
geom_text(data=label_data, aes(x=id, y=tot+10, label=company, hjust=hjust), color="black", fontface="bold",alpha=0.6, size=5, angle= label_data$angle, inherit.aes = FALSE ) +
# Add base line information (policy groups)
geom_segment(data=base_data, aes(x = start, y = -5, xend = end, yend = -5), colour = "black", alpha=0.8, size=0.6 , inherit.aes = FALSE )  +
geom_text(data=base_data, aes(x = title, y = -18, label=policy), hjust=c(1,1,0,0), colour = "black", alpha=0.8, size=4, fontface="bold", inherit.aes = FALSE)
# Save at png
ggsave(p, file="output.png", width=15, height=10)
# Make the plot
p <- ggplot(data) +
# Add the stacked bar
geom_bar(aes(x=as.factor(id), y=value, fill=rua_id), stat="identity", alpha=0.7) +
scale_fill_viridis_d(
option = "M"
name = "rua",
labels = c("self", "dmarcian", "Agari", "Proofpoint", "Vailmail", "Cisco", "Validity", "no reporting")) +
ylim(-150,max(label_data$tot+10, na.rm=T)) +
theme_minimal() +
theme(
legend.key = element_rect(fill = "white", colour = "black"),
axis.text = element_blank(),
axis.title = element_blank(),
panel.grid = element_blank(),
plot.margin = unit(rep(-1,4), "cm")
) +
coord_polar() +
#labs(fill = "rua") +
# Add labels on top of each bar (company name)
geom_text(data=label_data, aes(x=id, y=tot+10, label=company, hjust=hjust), color="black", fontface="bold",alpha=0.6, size=5, angle= label_data$angle, inherit.aes = FALSE ) +
# Add base line information (policy groups)
geom_segment(data=base_data, aes(x = start, y = -5, xend = end, yend = -5), colour = "black", alpha=0.8, size=0.6 , inherit.aes = FALSE )  +
geom_text(data=base_data, aes(x = title, y = -18, label=policy), hjust=c(1,1,0,0), colour = "black", alpha=0.8, size=4, fontface="bold", inherit.aes = FALSE)
# Save at png
ggsave(p, file="output.png", width=15, height=10)
# Make the plot
p <- ggplot(data) +
# Add the stacked bar
geom_bar(aes(x=as.factor(id), y=value, fill=rua_id), stat="identity", alpha=0.7) +
scale_fill_viridis_d(
option = "M",
name = "rua",
labels = c("self", "dmarcian", "Agari", "Proofpoint", "Vailmail", "Cisco", "Validity", "no reporting")) +
ylim(-150,max(label_data$tot+10, na.rm=T)) +
theme_minimal() +
theme(
legend.key = element_rect(fill = "white", colour = "black"),
axis.text = element_blank(),
axis.title = element_blank(),
panel.grid = element_blank(),
plot.margin = unit(rep(-1,4), "cm")
) +
coord_polar() +
#labs(fill = "rua") +
# Add labels on top of each bar (company name)
geom_text(data=label_data, aes(x=id, y=tot+10, label=company, hjust=hjust), color="black", fontface="bold",alpha=0.6, size=5, angle= label_data$angle, inherit.aes = FALSE ) +
# Add base line information (policy groups)
geom_segment(data=base_data, aes(x = start, y = -5, xend = end, yend = -5), colour = "black", alpha=0.8, size=0.6 , inherit.aes = FALSE )  +
geom_text(data=base_data, aes(x = title, y = -18, label=policy), hjust=c(1,1,0,0), colour = "black", alpha=0.8, size=4, fontface="bold", inherit.aes = FALSE)
# Save at png
ggsave(p, file="output.png", width=15, height=10)
# Make the plot
p <- ggplot(data) +
# Add the stacked bar
geom_bar(aes(x=as.factor(id), y=value, fill=rua_id), stat="identity", alpha=0.7) +
scale_fill_viridis_d(
option = "A",
name = "rua",
labels = c("self", "dmarcian", "Agari", "Proofpoint", "Vailmail", "Cisco", "Validity", "no reporting")) +
ylim(-150,max(label_data$tot+10, na.rm=T)) +
theme_minimal() +
theme(
legend.key = element_rect(fill = "white", colour = "black"),
axis.text = element_blank(),
axis.title = element_blank(),
panel.grid = element_blank(),
plot.margin = unit(rep(-1,4), "cm")
) +
coord_polar() +
#labs(fill = "rua") +
# Add labels on top of each bar (company name)
geom_text(data=label_data, aes(x=id, y=tot+10, label=company, hjust=hjust), color="black", fontface="bold",alpha=0.6, size=5, angle= label_data$angle, inherit.aes = FALSE ) +
# Add base line information (policy groups)
geom_segment(data=base_data, aes(x = start, y = -5, xend = end, yend = -5), colour = "black", alpha=0.8, size=0.6 , inherit.aes = FALSE )  +
geom_text(data=base_data, aes(x = title, y = -18, label=policy), hjust=c(1,1,0,0), colour = "black", alpha=0.8, size=4, fontface="bold", inherit.aes = FALSE)
# Save at png
ggsave(p, file="output.png", width=15, height=10)
# Make the plot
p <- ggplot(data) +
# Add the stacked bar
geom_bar(aes(x=as.factor(id), y=value, fill=rua_id), stat="identity", alpha=0.5) +
scale_fill_viridis_d(
name = "rua",
labels = c("self", "dmarcian", "Agari", "Proofpoint", "Vailmail", "Cisco", "Validity", "no reporting")) +
ylim(-150,max(label_data$tot+10, na.rm=T)) +
theme_minimal() +
theme(
legend.key = element_rect(fill = "white", colour = "black"),
axis.text = element_blank(),
axis.title = element_blank(),
panel.grid = element_blank(),
plot.margin = unit(rep(-1,4), "cm")
) +
coord_polar() +
#labs(fill = "rua") +
# Add labels on top of each bar (company name)
geom_text(data=label_data, aes(x=id, y=tot+10, label=company, hjust=hjust), color="black", fontface="bold",alpha=0.6, size=5, angle= label_data$angle, inherit.aes = FALSE ) +
# Add base line information (policy groups)
geom_segment(data=base_data, aes(x = start, y = -5, xend = end, yend = -5), colour = "black", alpha=0.8, size=0.6 , inherit.aes = FALSE )  +
geom_text(data=base_data, aes(x = title, y = -18, label=policy), hjust=c(1,1,0,0), colour = "black", alpha=0.8, size=4, fontface="bold", inherit.aes = FALSE)
# Save at png
ggsave(p, file="output.png", width=15, height=10)
# Make the plot
p <- ggplot(data) +
# Add the stacked bar
geom_bar(aes(x=as.factor(id), y=value, fill=rua_id), stat="identity", alpha=0.5) +
#scale_fill_viridis_d(
scale_fill_brewer(palette = "Paired"
name = "rua",
labels = c("self", "dmarcian", "Agari", "Proofpoint", "Vailmail", "Cisco", "Validity", "no reporting")) +
ylim(-150,max(label_data$tot+10, na.rm=T)) +
theme_minimal() +
theme(
legend.key = element_rect(fill = "white", colour = "black"),
axis.text = element_blank(),
axis.title = element_blank(),
panel.grid = element_blank(),
plot.margin = unit(rep(-1,4), "cm")
) +
coord_polar() +
#labs(fill = "rua") +
# Add labels on top of each bar (company name)
geom_text(data=label_data, aes(x=id, y=tot+10, label=company, hjust=hjust), color="black", fontface="bold",alpha=0.6, size=5, angle= label_data$angle, inherit.aes = FALSE ) +
# Add base line information (policy groups)
geom_segment(data=base_data, aes(x = start, y = -5, xend = end, yend = -5), colour = "black", alpha=0.8, size=0.6 , inherit.aes = FALSE )  +
geom_text(data=base_data, aes(x = title, y = -18, label=policy), hjust=c(1,1,0,0), colour = "black", alpha=0.8, size=4, fontface="bold", inherit.aes = FALSE)
# Save at png
ggsave(p, file="output.png", width=15, height=10)
# Make the plot
p <- ggplot(data) +
# Add the stacked bar
geom_bar(aes(x=as.factor(id), y=value, fill=rua_id), stat="identity", alpha=0.5) +
#scale_fill_viridis_d(
scale_fill_brewer(palette = "Paired",
name = "rua",
labels = c("self", "dmarcian", "Agari", "Proofpoint", "Vailmail", "Cisco", "Validity", "no reporting")) +
ylim(-150,max(label_data$tot+10, na.rm=T)) +
theme_minimal() +
theme(
legend.key = element_rect(fill = "white", colour = "black"),
axis.text = element_blank(),
axis.title = element_blank(),
panel.grid = element_blank(),
plot.margin = unit(rep(-1,4), "cm")
) +
coord_polar() +
#labs(fill = "rua") +
# Add labels on top of each bar (company name)
geom_text(data=label_data, aes(x=id, y=tot+10, label=company, hjust=hjust), color="black", fontface="bold",alpha=0.6, size=5, angle= label_data$angle, inherit.aes = FALSE ) +
# Add base line information (policy groups)
geom_segment(data=base_data, aes(x = start, y = -5, xend = end, yend = -5), colour = "black", alpha=0.8, size=0.6 , inherit.aes = FALSE )  +
geom_text(data=base_data, aes(x = title, y = -18, label=policy), hjust=c(1,1,0,0), colour = "black", alpha=0.8, size=4, fontface="bold", inherit.aes = FALSE)
# Save at png
ggsave(p, file="output.png", width=15, height=10)
# Make the plot
p <- ggplot(data) +
# Add the stacked bar
geom_bar(aes(x=as.factor(id), y=value, fill=rua_id), stat="identity") +
#scale_fill_viridis_d(
scale_fill_brewer(palette = "Paired",
name = "rua",
labels = c("self", "dmarcian", "Agari", "Proofpoint", "Vailmail", "Cisco", "Validity", "no reporting")) +
ylim(-150,max(label_data$tot+10, na.rm=T)) +
theme_minimal() +
theme(
legend.key = element_rect(fill = "white", colour = "black"),
axis.text = element_blank(),
axis.title = element_blank(),
panel.grid = element_blank(),
plot.margin = unit(rep(-1,4), "cm")
) +
coord_polar() +
#labs(fill = "rua") +
# Add labels on top of each bar (company name)
geom_text(data=label_data, aes(x=id, y=tot+10, label=company, hjust=hjust), color="black", fontface="bold",alpha=0.6, size=5, angle= label_data$angle, inherit.aes = FALSE ) +
# Add base line information (policy groups)
geom_segment(data=base_data, aes(x = start, y = -5, xend = end, yend = -5), colour = "black", alpha=0.8, size=0.6 , inherit.aes = FALSE )  +
geom_text(data=base_data, aes(x = title, y = -18, label=policy), hjust=c(1,1,0,0), colour = "black", alpha=0.8, size=4, fontface="bold", inherit.aes = FALSE)
# Save at png
ggsave(p, file="output.png", width=15, height=10)
